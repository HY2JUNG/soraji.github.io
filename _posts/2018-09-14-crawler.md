# Crawler

완벽히 개인적인 나만의 크롤러..



일반적으로 패키지안에 들어있는 클래스들 

~~~
G2BCrawlingListnerResult001.java => step이 끝나면 실행되는 마지막 클래스
G2BCrawlingResult001.java => 제일먼저 실행되는 클래스
G2BCrawlingResult00x.java => 크롤링 실행 클래스모음
G2BCrawlingSmallGui.java => 크롤링 GUI 클래스(껍데기형태만 존재함)
G2BCrawlingSmallGui.java => 크롤링 GUI 껍데기와 실제로 명령어들을 연결해주는 클래스
~~~

---

## properties



맨처음에 크롤러를 만들기 전에 conf/crawling.properties에서 기본 설정을 해두어야한다

~~~
## conf/crawling.properties 파일

init.패키지명.name=이름
init.패키지명.method=https통신 중 하나(get,post,delete)
init.패키지명.url=주소(타겟페이지 url을 쓰지 않아도 작동하지만 이 코드가 없으면 url이 null이라며 에러뜸, 엔진제작자가 init.url이 없으면 에러가 나도록 설정해놓음)
init.패키지명.step = 패키지명.제일먼저 시작하는 클래스
init.패키지명.listener = step이 끝나면 실행되는 마지막 클래스(크롤링이 끝나면 작동되는 클래스)
~~~



---

## rule

rule파일은 크롤링이 시작될, 이때 CrawlingAdapter도 함께 실행되는데 여기서 모든 rule파일을 가지고온뒤 적용을 한다. 

### 패턴선언

~~~
[pattern:조달청.시설.공지사항페이지정보]
{
  <p class="articles">￦s*? 
      총￦s*? 
      <span class="total">(￦d*?)</span>￦s*? 
      건￦s*? 
      : <span class="current">(￦d*?)/(￦d*?)</span>￦s*? 
      페이지￦s*? 
	</p>￦s*? 
}
~~~

* ￦s*?  : 줄바꿈. 문장이 끝났다는것을 알려주는 기호
* (￦d*?) : 가져오려고 하는 정보
* [^h]*? : h로 끝나는 공백을 포함한 모든 문자열
* .*? : 내용을 가져오고싶지는 않지만 내용이 계속 바뀌어서 패턴화 할 수 없는 것들



### Rule선언

~~~
[조달청.시설.공지사항페이지정보]
{
  (1)->[-]:총건수=1,현재페이지=2,총페이지=3;
}
~~~

* [xxxxxxx] : 중괄호안의 내용은 패턴선언의 패턴이름과 동일해야한다

* (1) : 한번만 돌아도 될때

* (each) : for문으로 반복으로 돌아야할때

* 가져오려는 정보=1 : 가져오려고 하는 첫번째 내용

* 가져오려는 정보=2 : 가져오려고하는 두번째 내용

  	결국에는 pattern에서의 (￦d*?) 의 갯수만큼 rule을 만들어주어야함



### Rule선언 확인

원하는 타겟페이지에 가서 '소스보기' 한뒤, 전체 소스 복사해와서, /bin/dev 에다가 원하는 이름으로 .html저장한다. 그리고  cmd에서 그 파일경로로 움직인뒤 명령어로 

~~~
parsingtest 원하는이름.html 패턴선언의 패턴이름
	## '',"" 은 없다!
~~~

을 치면, 제대로 rule선언이 되었다는 가정하에 rule에 대한 정보들이 뜬다. 혹 제대로 뜨지 않았다면 선언이 잘못된것.